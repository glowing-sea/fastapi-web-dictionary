{% extends "base.html" %}
{% block content %}
  <h1>Dictionary</h1>

  {% if dicts|length == 0 %}
    <div class="card">
      <p><strong>No dictionaries installed.</strong></p>
      <p class="hint">Ask an admin to upload an MDX ZIP in Admin: Dictionaries.</p>
    </div>
  {% else %}
    <section class="card">
      <form method="post" action="/dictionary/search" class="row searchbar">
        <div class="grow">
          <input class="biginput" name="query" placeholder="Search a word..." value="{{ query }}" autofocus />
        </div>
        <div>
          <select name="dict_id">
            {% for d in dicts %}
              <option value="{{ d.id }}" {% if d.id == selected_dict_id %}selected{% endif %}>{{ d.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div><button type="submit">Search</button></div>
      </form>
      <p class="hint">Tip: searches are case-sensitive in many MDX dictionaries.</p>
    </section>

    
{% if result %}
  <section class="card">
    <div class="row space-between">
      <h2>Matches for: {{ result.lookup_key }}</h2>
      {% if result.found %}
        <form method="post" action="/dictionary/favourite" class="row">
          <input type="hidden" name="dict_id" value="{{ selected_dict_id }}" />
          <input type="hidden" name="headword" value="{{ result.lookup_key }}" />
          <input name="notes" placeholder="Optional notes..." class="notesinput" />
          <button type="submit">‚≠ê Favourite</button>
        </form>
      {% endif %}
    </div>

    {% if not result.found %}
      <p><em>Not found.</em></p>
    {% else %}
      <div class="hint">Showing {{ result.entries|length }} matching record(s).</div>
      {% for e in result.entries %}
        <article class="card">
          <h3>{{ e.headword }}</h3>
          <div class="definition">{{ e.html | safe }}</div>
        </article>
      {% endfor %}
    {% endif %}
  </section>
{% endif %}
{% endif %}
{% endblock %}
